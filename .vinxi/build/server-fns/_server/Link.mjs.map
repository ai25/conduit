{"version":3,"file":"Link.mjs","sources":["../../../../src/stores/appStateStore.tsx","../../../../src/components/Link.tsx"],"sourcesContent":["import { createContext, useContext } from \"solid-js\";\nimport { createStore } from \"solid-js/store\";\nimport { ProviderStatus } from \"~/components/Header\";\n\nconst store = createStore({\n  loading: false,\n  touchInProgress: false,\n  sync: {\n    providers: {\n      idb: \"disconnected\" as ProviderStatus,\n      webrtc: \"disconnected\" as ProviderStatus,\n      opfs: \"disconnected\" as ProviderStatus,\n    },\n    syncing: false,\n    lastSync: 0,\n    userId: 0,\n    users: [] as { id: number; name: string }[],\n  },\n  player: {\n    small: false,\n    dismissed: false,\n    lastVideoUrl: \"\",\n  }\n});\nconst AppStateContext = createContext(store);\nexport const AppStateProvider = (props: { children: any }) => {\n  return (\n    <AppStateContext.Provider value={store}>\n      {props.children}\n    </AppStateContext.Provider>\n  );\n};\nexport const useAppState = () => {\n  const context = useContext(AppStateContext);\n  return context;\n};\n","import { A, useSearchParams } from \"@solidjs/router\";\nimport { createEffect, createSignal } from \"solid-js\";\nimport { useAppState } from \"~/stores/appStateStore\";\n\nexport default function Link(props: LinkProps) {\n  const [searchParams] = useSearchParams();\n  const [href, setHref] = createSignal(props.href);\n  const [appState, setAppState] = useAppState();\n\n  createEffect(() => {\n    const fullscreen = searchParams.fullscreen === \"true\";\n    try {\n      const hrefUrl = new URL(`${window.location.origin}${props.href}`);\n      if (fullscreen) {\n        hrefUrl.searchParams.set(\"fullscreen\", \"true\");\n      } else {\n        hrefUrl.searchParams.delete(\"fullscreen\");\n      }\n      const relativePath = hrefUrl.pathname;\n\n      setHref(`${relativePath}${hrefUrl.search}${hrefUrl.hash}`);\n    } catch (e) {\n      console.error(e, props.href);\n    }\n  });\n\n  return (\n    <A\n      onClick={(e) => {\n        // hack to get around the touch events propagating down\n        if (appState.touchInProgress) {\n          e.preventDefault();\n          e.stopPropagation();\n          setTimeout(() => {\n            setAppState(\"touchInProgress\", false);\n          }, 100);\n        }\n      }}\n      href={href()}\n      class={props.class}\n      style={props.style}\n      activeClass={props.activeClass}\n      inactiveClass={props.inactiveClass}\n    >\n      {props.children}\n    </A>\n  );\n}\ninterface LinkProps {\n  href: string;\n  class?: string;\n  style?: any;\n  children?: any;\n  activeClass?: string;\n  inactiveClass?: string;\n}\n"],"names":["store","createStore","loading","touchInProgress","sync","providers","idb","webrtc","opfs","syncing","lastSync","userId","users","player","small","dismissed","lastVideoUrl","AppStateContext","createContext","AppStateProvider","props","_$createComponent","Provider","value","children","useAppState","useContext","Link","searchParams","useSearchParams","href","setHref","createSignal","appState","setAppState","createEffect","fullscreen","hrefUrl","URL","window","location","origin","set","delete","relativePath","pathname","search","hash","e","error","A","onClick","preventDefault","stopPropagation","setTimeout","class","style","activeClass","inactiveClass"],"mappings":"gQAIA,MAAMA,EAAQC,EAAY,CACxBC,QAAS,GACTC,gBAAiB,GACjBC,KAAM,CACJC,UAAW,CACTC,IAAK,eACLC,OAAQ,eACRC,KAAM,cACR,EACAC,QAAS,GACTC,SAAU,EACVC,OAAQ,EACRC,MAAO,EACT,EACAC,OAAQ,CACNC,MAAO,GACPC,UAAW,GACXC,aAAc,EAChB,CACF,CAAC,EACKC,EAAkBC,EAAclB,CAAK,EAC9BmB,EAAoBC,GAC/BC,EACGJ,EAAgBK,SAAQ,CAACC,MAAOvB,EAAK,IAAAwB,UAAA,CAAA,OACnCJ,EAAMI,QAAQ,CAAA,CAAA,EAIRC,EAAcA,IACTC,EAAWT,CAAe,EC7B5C,SAAwBU,EAAKP,EAAkB,CACvC,KAAA,CAACQ,CAAY,EAAIC,IACjB,CAACC,EAAMC,CAAO,EAAIC,EAAaZ,EAAMU,IAAI,EACzC,CAACG,EAAUC,CAAW,EAAIT,EAAY,EAE5CU,OAAAA,EAAa,IAAM,CACXC,MAAAA,EAAaR,EAAaQ,aAAe,OAC3C,GAAA,CACIC,MAAAA,EAAU,IAAIC,IAAK,GAAEC,OAAOC,SAASC,MAAO,GAAErB,EAAMU,IAAK,EAAC,EAC5DM,EACMR,EAAAA,aAAac,IAAI,aAAc,MAAM,EAErCd,EAAAA,aAAae,OAAO,YAAY,EAE1C,MAAMC,EAAeP,EAAQQ,SAEpBd,EAAA,GAAEa,CAAa,GAAEP,EAAQS,MAAO,GAAET,EAAQU,IAAK,EAAC,QAClDC,EAAG,CACFC,QAAAA,MAAMD,EAAG5B,EAAMU,IAAI,CAC7B,CAAA,CACD,EAEDT,EACG6B,EAAC,CACAC,QAAgBH,GAAA,CAEVf,EAAS9B,kBACX6C,EAAEI,eAAe,EACjBJ,EAAEK,gBAAgB,EAClBC,WAAW,IAAM,CACfpB,EAAY,kBAAmB,EAAK,GACnC,GAAG,EAEV,EAAC,IACDJ,MAAI,CAAA,OAAEA,EAAK,CAAC,EAAA,IAAA,OAAA,CAAA,OACLV,EAAMmC,KAAK,EAAA,IAClBC,OAAK,CAAA,OAAEpC,EAAMoC,KAAK,EAAA,IAClBC,aAAW,CAAA,OAAErC,EAAMqC,WAAW,EAAA,IAC9BC,eAAa,CAAA,OAAEtC,EAAMsC,aAAa,EAAA,IAAAlC,UAAA,CAAA,OAEjCJ,EAAMI,QAAQ,CAAA,CAAA,CAGrB"}