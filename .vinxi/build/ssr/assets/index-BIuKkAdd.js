import{isServer as f,createComponent as v,spread as u}from"solid-js/web";import{createContext as T,createUniqueId as N,useContext as C,createRenderEffect as y,onCleanup as x,sharedConfig as E}from"solid-js";const m=T(),p=["title","meta"],h=n=>n.tag+(n.name?`.${n.name}"`:""),S=n=>{if(!f&&!E.context){const e=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(e,t=>t.parentNode.removeChild(t))}const o=new Map;function i(e){if(e.ref)return e.ref;let t=document.querySelector(`[data-sm="${e.id}"]`);return t?(t.tagName.toLowerCase()!==e.tag&&(t.parentNode&&t.parentNode.removeChild(t),t=document.createElement(e.tag)),t.removeAttribute("data-sm")):t=document.createElement(e.tag),t}const l={addClientTag:e=>{let t=h(e);if(p.indexOf(e.tag)!==-1){o.has(t)||o.set(t,[]);let r=o.get(t),d=r.length;if(r=[...r,e],o.set(t,r),!f){let s=i(e);e.ref=s,u(s,e.props);let c=null;for(var a=d-1;a>=0;a--)if(r[a]!=null){c=r[a];break}s.parentNode!=document.head&&document.head.appendChild(s),c&&c.ref&&document.head.removeChild(c.ref)}return d}if(!f){let r=i(e);e.ref=r,u(r,e.props),r.parentNode!=document.head&&document.head.appendChild(r)}return-1},removeClientTag:(e,t)=>{const a=h(e);if(e.ref){const r=o.get(a);if(r){if(e.ref.parentNode){e.ref.parentNode.removeChild(e.ref);for(let d=t-1;d>=0;d--)r[d]!=null&&document.head.appendChild(r[d].ref)}r[t]=null,o.set(a,r)}else e.ref.parentNode&&e.ref.parentNode.removeChild(e.ref)}}};if(f&&(l.addServerTag=e=>{const{tags:t=[]}=n;if(p.indexOf(e.tag)!==-1){const a=t.findIndex(r=>{const d=r.props.name||r.props.property,s=e.props.name||e.props.property;return r.tag===e.tag&&d===s});a!==-1&&t.splice(a,1)}t.push(e)},Array.isArray(n.tags)===!1))throw Error("tags array should be passed to <MetaProvider /> in node");return v(m.Provider,{value:l,get children(){return n.children}})},M=(n,o,i)=>{const l=N();if(!C(m))throw new Error("<MetaProvider /> should be in the tree");return g({tag:n,props:o,setting:i,id:l,get name(){return o.name||o.property}}),null};function g(n){const{addClientTag:o,removeClientTag:i,addServerTag:l}=C(m);if(y(()=>{if(!f){let e=o(n);x(()=>i(n,e))}}),f)return l(n),null}const b=n=>M("title",n,{escape:!0,close:!0});export{S as M,b as T};
//# sourceMappingURL=index-BIuKkAdd.js.map
